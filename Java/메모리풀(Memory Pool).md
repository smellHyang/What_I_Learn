# 메모리풀(Memory Pool)

1. 메모리풀(Memory Pool)? 
    - 메모리를 미리 확보해 놓고 재사용하는 것
    - 메모리 할당 및 해제 작업등을 유저가 직접 다룰수 있도록 만든 객체
    
2. 메모리 단편화
    - 메모리 공간에 빈공간이 생겨 충분히 사용할 수 있음게도 불구하고 할당받지 못하는 상태
    - 내부 단편화 - 프로세스가 필요한 크기보다 할당된 메모리가 더커서 메모리공간이 낭비되는 현상(프로세르 50, 할당 메모리공간 30 = 20mb가 남음)
        
        ![Untitled](%E1%84%86%E1%85%A6%E1%84%86%E1%85%A9%E1%84%85%E1%85%B5%E1%84%91%E1%85%AE%E1%86%AF(%20c59af/Untitled.png)
        
    - 외부 단편화 - 메모리 할당 및 해제 과정에서 메모리공간이 비게 되는데 여러개로 나뉘어져 있어서 내가 필요로하는 크기보다 작아서 사용할수 없는 경우
        
        
        ![Untitled](%E1%84%86%E1%85%A6%E1%84%86%E1%85%A9%E1%84%85%E1%85%B5%E1%84%91%E1%85%AE%E1%86%AF(%20c59af/Untitled%201.png)
        

1. why 사용하는가?
    - 매번 메모리를 할당, 해제하지 않고 메모리 풀에 들어 있는 자원을 재사용함으로써 단편화를 줄이고 메모리 사용 성능을 개선하기 위해
    - OS에게 메모리 할당/해제를 요청하면 데이터 뿐만 아니라 기타정보까지 포함하여 메모리를 할당하기 때문에 작은 메모리를 자주 요청하는 경우 필요이상의 메모리를 사용하게 되고 많은 비용을 발생시킨다.
    - 따라서 유저가 큰 메모리를 미리 할당받고 필요한 곳에 빌려주고 돌려받는 형식.
    
2. 특징
    - 사용하지 않는 순간에도 미리 할당해놓는 방식이기 때문에 메모리 누수가 있을 수 가 있다..
    - 메모리 할당 및 해제가 빈번할때 사용하는게 좋음.

+) 단편화 현상 줄이는 방법

- 페이징 기법(Paging)
    - 가상메모리 사용, 외부단편화 해결, 내부단편화 존재
    - 사용하지 않는 RAM 공간 → 보조기억장치 공간, 
    필요한 메모리를 보조기억장치 공간 → RAM 공간
    - 연속적이지 않은 공간도 활용할 수 있기에 외부 단편화 해결
    - 보조기억장치 공간 단위에 맞게 사용되지 않으므로 내부단편화 존대
    - 보조기억장치 공간 단위를 작게하면 내부단편화 해결은 되지만 page mapping과정이 빈번해져 효율 감소
- 세그멘테이션(Segmentation)
    - 가상메모리 사용, 외부단편화 존재, 내부단편화 해결
    - 서로 크기가 다른 논리적 단위인 세그먼트로 분할하여 메모리 할당
    - 각 세그먼트는 연속적인 공간에 저장되어 있음
    - 크기가 다르기 때문에 미리 분할 해 둘수 없고 메모리에 적재될때 빈 공간을 찾아 할당
    - 필요한 메모리 만큼 사용하기 때문에 내부단편화 해결 → 프로세스가 메모리를 해제하면 생기는 외부단편화 존재
